{% extends 'base.html' %}

{% block title %}パスワード変更 - KifuCloud{% endblock title %}

{% block extra_css %}
<link rel="stylesheet" href="{{ static(master, 'css/accounts.css') }}">
{% endblock extra_css %}

{% block content %}
<div class="account-page fade-in">
  <div class="account-container">
    <!-- Page Header -->
    <div class="account-header">
      <h1 class="account-title">パスワード変更</h1>
      <p class="account-subtitle">
        アカウントのセキュリティを保つため、強力なパスワードを設定してください
      </p>
    </div>


    <!-- Main Content -->
    <div class="account-main-single slide-up">
        <!-- Password Change Section -->
        <div class="account-section">
          <div class="section-header">
            <i data-lucide="key" class="section-icon"></i>
            <h2 class="section-title">新しいパスワードの設定</h2>
          </div>

          {% if error %}
          <div class="account-alert error">
            <i data-lucide="alert-circle" class="alert-icon"></i>
            <div>{{ error }}</div>
          </div>
          {% endif %}

          {% if message %}
          <div class="account-alert success">
            <i data-lucide="check-circle" class="alert-icon"></i>
            <div>{{ message }}</div>
          </div>
          {% endif %}

          <form method="post" class="account-form" id="changePasswordForm">
            <div class="form-group">
              <label class="form-label">{{ form.current_password.label }}</label>
              {{ form.current_password(class="form-input" + (" error" if form.current_password.errors else ""), id="currentPassword") }}
              {% if form.current_password.errors %}
              <div class="form-error">
                <i data-lucide="alert-circle" style="width: 14px; height: 14px;"></i>
                {% for error in form.current_password.errors %}
                {{ error }}
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <div class="form-group">
              <label class="form-label">{{ form.new_password.label }}</label>
              {{ form.new_password(class="form-input" + (" error" if form.new_password.errors else ""), id="newPassword") }}
              {% if form.new_password.errors %}
              <div class="form-error">
                <i data-lucide="alert-circle" style="width: 14px; height: 14px;"></i>
                {% for error in form.new_password.errors %}
                {{ error }}
                {% endfor %}
              </div>
              {% endif %}
              <div class="form-help">
                8文字以上で、英数字と記号を組み合わせてください
              </div>

              <!-- Password Strength Indicator -->
              <div class="password-strength" id="passwordStrength" style="display: none;">
                <div class="strength-label">パスワードの強度:</div>
                <div class="strength-bar">
                  <div class="strength-fill" id="strengthFill"></div>
                </div>
                <div class="strength-text" id="strengthText"></div>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">{{ form.confirm_password.label }}</label>
              {{ form.confirm_password(class="form-input" + (" error" if form.confirm_password.errors else ""), id="confirmPassword") }}
              {% if form.confirm_password.errors %}
              <div class="form-error">
                <i data-lucide="alert-circle" style="width: 14px; height: 14px;"></i>
                {% for error in form.confirm_password.errors %}
                {{ error }}
                {% endfor %}
              </div>
              {% endif %}
              <div class="password-match" id="passwordMatch" style="display: none;"></div>
            </div>

            <div class="form-actions">
              <button type="submit" class="form-submit" id="submitBtn">
                <i data-lucide="key" class="btn-icon"></i>
                パスワードを変更
              </button>
              <a href="{{ reverse(master, 'accounts:profile') }}" class="action-btn secondary">
                <i data-lucide="arrow-left" class="btn-icon"></i>
                キャンセル
              </a>
            </div>
          </form>
        </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block extra_js %}
<script src="{{ static(master, 'js/accounts.js') }}"></script>
{% endblock extra_js %}