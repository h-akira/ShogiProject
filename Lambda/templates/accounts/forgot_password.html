{% extends 'base.html' %}

{% block title %}パスワードを忘れた場合 - KifuCloud{% endblock title %}

{% block extra_css %}
<link rel="stylesheet" href="{{ static(master, 'css/accounts.css') }}">
{% endblock extra_css %}

{% block content %}
<div class="account-page fade-in">
  <div class="account-container">
    <!-- Page Header -->
    <div class="account-header">
      <h1 class="account-title">パスワードを忘れた場合</h1>
      <p class="account-subtitle">
        パスワードリセット用の確認コードをメールで送信します
      </p>
    </div>

    <!-- Progress Steps -->
    <div class="progress-steps">
      <div class="progress-step active">
        <div class="step-circle">1</div>
        <div class="step-label">ユーザー名入力</div>
      </div>
      <div class="progress-step">
        <div class="step-circle">2</div>
        <div class="step-label">確認コード入力</div>
      </div>
      <div class="progress-step">
        <div class="step-circle">3</div>
        <div class="step-label">パスワード設定</div>
      </div>
    </div>

    <!-- Breadcrumb -->
    <nav class="account-breadcrumb">
      <ol class="breadcrumb-list">
        <li class="breadcrumb-item">
          <a href="{{ reverse(master, 'home') }}" class="breadcrumb-link">ホーム</a>
          <span class="breadcrumb-separator">›</span>
        </li>
        <li class="breadcrumb-item">
          <a href="{{ reverse(master, 'accounts:login') }}" class="breadcrumb-link">ログイン</a>
          <span class="breadcrumb-separator">›</span>
        </li>
        <li class="breadcrumb-item">
          <span class="breadcrumb-current">パスワードリセット</span>
        </li>
      </ol>
    </nav>

    <!-- Main Content Grid -->
    <div class="account-grid">
      <div class="account-main slide-up">
        <div class="account-section">
          <div class="section-header">
            <i data-lucide="mail" class="section-icon"></i>
            <h2 class="section-title">確認コード送信</h2>
          </div>

          <div class="account-alert info">
            <i data-lucide="info" class="alert-icon"></i>
            <div>
              ユーザー名を入力してください。登録されているメールアドレスに、パスワードリセット用の6桁の確認コードを送信します。
            </div>
          </div>

          {% if error %}
          <div class="account-alert error">
            <i data-lucide="alert-circle" class="alert-icon"></i>
            <div>{{ error }}</div>
          </div>
          {% endif %}

          <form method="post" class="account-form" id="forgotPasswordForm">
            <div class="form-group">
              <label class="form-label">{{ form.username.label }}</label>
              {{ form.username(class="form-input" + (" error" if form.username.errors else ""), id="username", autocomplete="username") }}
              {% if form.username.errors %}
              <div class="form-error">
                <i data-lucide="alert-circle" style="width: 14px; height: 14px;"></i>
                {% for error in form.username.errors %}
                {{ error }}
                {% endfor %}
              </div>
              {% endif %}
              <div class="form-help">
                アカウント作成時に使用したユーザー名を入力してください
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="form-submit" id="submitBtn">
                <i data-lucide="mail" class="btn-icon"></i>
                確認コードを送信
              </button>
              <a href="{{ reverse(master, 'accounts:login') }}" class="action-btn secondary">
                <i data-lucide="arrow-left" class="btn-icon"></i>
                ログインに戻る
              </a>
            </div>
          </form>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="account-sidebar slide-up">
        <h3 class="sidebar-title">よくある質問</h3>
        <div class="help-content">
          <div style="margin-bottom: var(--space-lg);">
            <h4 style="font-size: 0.875rem; font-weight: var(--font-weight-semibold); margin-bottom: var(--space-sm); color: var(--text-primary);">メールが届かない場合</h4>
            <ul class="help-list">
              <li>迷惑メールフォルダを確認してください</li>
              <li>数分お待ちいただき、再度お試しください</li>
              <li>ユーザー名に間違いがないか確認してください</li>
            </ul>
          </div>

          <div style="margin-bottom: var(--space-lg);">
            <h4 style="font-size: 0.875rem; font-weight: var(--font-weight-semibold); margin-bottom: var(--space-sm); color: var(--text-primary);">ユーザー名を忘れた場合</h4>
            <p style="font-size: 0.75rem; color: var(--text-secondary); line-height: 1.5;">
              アカウント作成時のメールを確認するか、管理者にお問い合わせください。
            </p>
          </div>
        </div>

        <div class="help-box">
          <div class="help-title">
            <i data-lucide="shield" style="width: 14px; height: 14px;"></i>
            セキュリティについて
          </div>
          <div class="help-content">
            <p>確認コードの有効期限は24時間です。第三者によるリセット試行があった場合は、すぐに管理者にご連絡ください。</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block extra_js %}
<script src="{{ static(master, 'js/accounts.js') }}"></script>
{% endblock extra_js %}