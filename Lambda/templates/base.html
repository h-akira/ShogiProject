<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ static(master, 'css/main.css') }}">
    
    <!-- Extra CSS -->
    {% block extra_css %}{% endblock extra_css %}
    
    <title>{% block title %}KifuCloud{% endblock title %}</title>
  </head>
  <body>
    <!-- Header Navigation -->
    <header class="header">
      <nav class="nav-container">
        <div class="nav-brand">
          <a href="{{ reverse(master, 'home') }}" class="nav-logo">
            <span class="logo-icon">ðŸ“‹</span>
            <span class="logo-text">KifuCloud</span>
          </a>
        </div>
        
        <div class="nav-links" id="navLinks">
          {% if master.request.auth %}
          <a href="{{ reverse(master, 'kifu:index', username=master.request.username) }}" class="nav-link">
            <i data-lucide="user" class="nav-icon"></i>
            <span>ãƒžã‚¤ãƒšãƒ¼ã‚¸</span>
          </a>
          <a href="{{ reverse(master, 'kifu:create', username=master.request.username) }}" class="nav-link">
            <i data-lucide="plus-circle" class="nav-icon"></i>
            <span>æ£‹è­œç™»éŒ²</span>
          </a>
          <a href="{{ reverse(master, 'kifu:explorer', username=master.request.username) }}" class="nav-link">
            <i data-lucide="search" class="nav-icon"></i>
            <span>ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼</span>
          </a>
          <a href="{{ reverse(master, 'tag:index', username=master.request.username) }}" class="nav-link">
            <i data-lucide="tag" class="nav-icon"></i>
            <span>ã‚¿ã‚°</span>
          </a>
          <div class="nav-user-info auth-link">
            <span class="nav-link" style="pointer-events: none;">
              <i data-lucide="user" class="nav-icon"></i>
              <span>{{ master.request.username }}</span>
            </span>
            <a href="{{ get_logout_url(master) }}" class="nav-link">
              <i data-lucide="log-out" class="nav-icon"></i>
              <span>Logout</span>
            </a>
          </div>
          {% else %}
          <a href="{{ get_login_url(master) }}" class="nav-link auth-link">
            <i data-lucide="log-in" class="nav-icon"></i>
            <span>Log in</span>
          </a>
          {% if master.settings.DENY_SIGNUP %}
          <span class="nav-link auth-link" style="opacity: 0.5; cursor: not-allowed;">
            <i data-lucide="lock" class="nav-icon"></i>
            <span>Sign up</span>
          </span>
          {% else %}
          <a href="{{ get_signup_url(master) }}" class="nav-link auth-link">
            <i data-lucide="user-plus" class="nav-icon"></i>
            <span>Sign up</span>
          </a>
          {% endif %}
          {% endif %}
        </div>
        
        <div class="nav-actions">
          {% if master.request.auth %}
          <div class="user-menu">
            <span class="user-name">{{ master.request.username }}</span>
            <a href="{{ get_logout_url(master) }}" class="btn btn-secondary btn-sm">
              <i data-lucide="log-out" class="btn-icon"></i>
              Logout
            </a>
          </div>
          {% else %}
          <div class="auth-buttons">
            <a href="{{ get_login_url(master) }}" class="btn btn-ghost btn-sm">Log in</a>
            {% if master.settings.DENY_SIGNUP %}
            <button class="btn btn-primary btn-sm" disabled>
              <i data-lucide="lock" style="width: 14px; height: 14px; margin-right: 4px;"></i>
              Sign up
            </button>
            {% else %}
            <a href="{{ get_signup_url(master) }}" class="btn btn-primary btn-sm">Sign up</a>
            {% endif %}
          </div>
          {% endif %}
        </div>
        
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
          <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </button>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      {% block content %}{% endblock content %}
    </main>

    <!-- Scripts -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="{{ static(master, 'js/menu.js') }}"></script>
    <script src="{{ static(master, 'js/base.js') }}"></script>
    
    <!-- Extra JavaScript -->
    {% block extra_js %}{% endblock extra_js %}
  </body>
</html>
