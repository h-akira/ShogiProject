{% extends 'base.html' %}
{% block extra_css %}
<link rel="stylesheet" href="{{ static(master, 'css/index.css') }}">
{% endblock extra_css %}

{% block title %}{{ username }} - マイページ{% endblock title %}

{% block content %}
<div class="dashboard-page">
  <div class="container">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
      <div class="user-avatar">
        {{ username[0]|upper }}
      </div>
      <h1 class="dashboard-user-name">{{ username }}</h1>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <a href="{{ reverse(master, 'kifu:create', username=username) }}" class="action-button">
        <i data-lucide="plus-circle" style="width: 20px; height: 20px;"></i>
        棋譜を登録
      </a>
      <a href="{{ reverse(master, 'kifu:explorer', username=username) }}" class="action-button secondary">
        <i data-lucide="search" style="width: 20px; height: 20px;"></i>
        エクスプローラー
      </a>
      <a href="{{ reverse(master, 'tag:index', username=username) }}" class="action-button secondary">
        <i data-lucide="tag" style="width: 20px; height: 20px;"></i>
        タグ管理
      </a>
    </div>

    <!-- Recent Updates -->
    <div class="recent-section">
      <h2 class="section-title">
        <i data-lucide="clock" class="section-icon"></i>
        最近の更新
      </h2>

      {% if latest_update_items %}
      <div class="kifu-grid">
        {% for item in latest_update_items %}
        <div class="kifu-card">
          <a href="{{ reverse(master, 'kifu:detail', username=username, kid=item.kid) }}" class="kifu-title">
            {{ item.slug }}
          </a>
          
          <div class="kifu-meta">
            <i data-lucide="calendar" style="width: 16px; height: 16px;"></i>
            <span>最終更新: {{ item.latest_update }}</span>
          </div>

          {% if item.tags and item.tags|length > 0 %}
          <div class="kifu-tags">
            {% for tag in item.tags %}
            <a href="{{ reverse(master, 'tag:detail', username=username, tid=tag.tid) }}" class="tag">
              {{ tag.tname }}
            </a>
            {% endfor %}
          </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="empty-state">
        <i data-lucide="file-plus" class="empty-icon"></i>
        <h3 style="font-size: 1.25rem; margin-bottom: var(--space-sm); color: var(--text-primary);">まだ棋譜が登録されていません</h3>
        <p>最初の棋譜を登録して、あなたの将棋の記録を始めましょう。</p>
        <div style="margin-top: var(--space-lg);">
          <a href="{{ reverse(master, 'kifu:create', username=username) }}" class="action-button">
            <i data-lucide="plus-circle" style="width: 20px; height: 20px;"></i>
            棋譜を登録
          </a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock content %}
{# <div class="padding-side"> #}
{#   <div class="columns"> #}
{#     <div class="column padding-side"> #}
{#       <div class="card card-bordered"> #}
{#         <div class="card-content"> #}
{#           <h3 class="title is-3 has-text-centered">階層図</h3> #}
{#           <div class="tree"> #}
{#             {% for html in tree_htmls %} #}
{#             {{ html | safe  }} #}
{#             {% endfor %} #}
{#           </div> #}
{#         </div> #}
{#       </div> #}
{#     </div> #}
{#     <div class="column"> #}
{#       <div class="card card-bordered"> #}
{#         <div class="card-content"> #}
{#           <h3 class="title is-3 has-text-centered">最近の更新</h3> #}
{#           {% for page in pages %} #}
{#           <h5 class="title is-5"> #}
{#             {{ page.title }} #}
{#           </h5> #}
{#           <p> #}
{#             <a href="{{ 'wiki:detail'|url_for_slug(username=page.username, slug=page.slug) }}"> #}
{#               {{ page.username }}/{{ page.slug }} #}
{#             </a> #}
{#           </p> #}
{#           <p> #}
{#             (最終更新:{{ page.last_updated }}) #}
{#           </p> #}
{#           {% if not loop.last %} #}
{#             <hr> #}
{#           {% endif %} #}
{#           {% endfor %} #}
{#         </div> #}
{#       </div> #}
{#     </div> #}
{#   </div> #}
{# </div> #}

{% block extra_js %}
{% endblock extra_js %}
